<link href="../libraries/polymer/polymer.html" rel="import">
<dom-module id="task-action">
	<template>
		<style>
			:host, div {
				position: absolute;
				right: 32px;
				bottom: 32px;
				width: 64px;
				height: 64px;
				border-radius: 32px;
				background-color: #ff5722;
				display: flex;
				justify-content: center;
				align-items: center;
				color: white;
				cursor: pointer;
			}

			:host.pressed, div.pressed {
				background-color: #f5f5f5;
				color: #9e9e9e;
			}

			div.action-refresh {
				right: 0;
				bottom: 192px;
				opacity: 1;
			}

			div.action-unread {
				right: 136px;
				bottom: 136px;
				opacity: 1;
			}

			div.action-read {
				right: 192px;
				bottom: 0;
				opacity: 1;
			}

			div[class~="action-refresh"].pressed {
				right: 0;
				bottom: 96px;
				opacity: 0;
			}

			div[class~="action-unread"].pressed {
				right: 68px;
				bottom: 68px;
				opacity: 0;
			}

			div[class~="action-read"].pressed {
				right: 96px;
				bottom: 0;
				opacity: 0;
			}
		</style>
		<i>view_list</i>

		<div class="action-refresh shadow-floating transition pressed">
			<i>refresh</i>
		</div>
		<div class="action-unread shadow-floating transition pressed">
			<i>close</i>
		</div>
		<div class="action-read shadow-floating transition pressed">
			<i>done_all</i>
		</div>
	</template>
	<script>
		Polymer({
			is: 'task-action',
			properties: {
				tasks: {
					type: Array,
					value: [],
					readOnly: false,
					notify: true,
					reflectToAttribute: false
				}
			},
			created: function () {
				this.classList.add('shadow-floating');
			},
			attached: function () {
				this.listen(this, tapEventName, 'toggle');
			},
			detached: function () {
				this.unlisten(this, tapEventName, 'toggle');
			},
			toggle: function (event) {
				event.stopPropagation();
				var classes = this.classList;
				var elements = this.getElementsByTagName('div');
				var length = elements.length;
				var i;
				if (classes.contains('pressed')) {
					for (i = 0; i < length; i++) elements[i].classList.add('pressed');
					classes.remove('pressed');
					setTimeout(function () {
						for (var i = 0; i < length; i++) elements[i].classList.add('hidden');
					}, 150);
				} else {
					for (i = 0; i < length; i++) elements[i].classList.remove('hidden');
					setTimeout(function () {
						classes.add('pressed');
						for (var i = 0; i < length; i++) elements[i].classList.remove('pressed');
					}, 0);
				}
			}
		})
	</script>
</dom-module>
